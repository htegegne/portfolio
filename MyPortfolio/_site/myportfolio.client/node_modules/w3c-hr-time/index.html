<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>w3c-hr-time | portfolio</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="w3c-hr-time" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/myportfolio.client/node_modules/w3c-hr-time/" />
<meta property="og:url" content="http://localhost:4000/myportfolio.client/node_modules/w3c-hr-time/" />
<meta property="og:site_name" content="portfolio" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="w3c-hr-time" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"w3c-hr-time","url":"http://localhost:4000/myportfolio.client/node_modules/w3c-hr-time/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=059dd2210d8f0fb8d42af0cbb5c1b29e59b98886">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">portfolio</a></h1>
      

      <h1 id="w3c-hr-time">w3c-hr-time</h1>

<p>This module implements the W3C <a href="https://w3c.github.io/hr-time/">High Resolution Time Level 2</a> specification. It provides exactly three exports:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Performance</code> class</li>
  <li><code class="language-plaintext highlighter-rouge">getGlobalMonotonicClockMS(): number</code></li>
  <li><code class="language-plaintext highlighter-rouge">clockIsAccurate: boolean</code></li>
</ul>

<p>In all APIs, a “high-resolution timestamp” means a number in milliseconds that may have a fractional part, if the system clock is accurate enough (see “Clock accuracy” section below). It is identical to the <a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp"><code class="language-plaintext highlighter-rouge">DOMHighResTimeStamp</code></a> type in the High Resolution Time spec.</p>

<p>Portability is paramount to this module. It uses only APIs exposed from Node.js core like <code class="language-plaintext highlighter-rouge">Date.now()</code> and <code class="language-plaintext highlighter-rouge">process.hrtime()</code> and does not use or require any native modules. It also employs the <a href="https://www.npmjs.com/package/browser-process-hrtime">browser-process-hrtime</a> module for graceful degrades for platforms that do not have <code class="language-plaintext highlighter-rouge">process.hrtime()</code> (such as browsers).</p>

<h2 id="performance-class"><code class="language-plaintext highlighter-rouge">Performance</code> class</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">Performance</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">w3c-hr-time</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">performance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Performance</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">timeOrigin</span><span class="p">);</span>
<span class="c1">// Prints a number close to Date.now() but that may have fractional parts, like</span>
<span class="c1">// 1514888563819.351.</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">timeOrigin</span><span class="p">));</span>
<span class="c1">// Prints a date close to new Date(), like 2018-01-02T10:22:43.819Z.</span>

<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
  <span class="c1">// Prints a number close to 5000, like 5008.023059.</span>
<span class="p">},</span> <span class="mi">5000</span><span class="p">);</span>
</code></pre></div></div>

<p>Perhaps the most interesting export is the <a href="https://w3c.github.io/hr-time/#dfn-performance"><code class="language-plaintext highlighter-rouge">Performance</code></a> class. By constructing the class, you can get an instance quite similar to the <code class="language-plaintext highlighter-rouge">window.performance</code> object in browsers. Specifically, the following APIs are implemented:</p>

<ul>
  <li><a href="https://w3c.github.io/hr-time/#dom-performance-now"><code class="language-plaintext highlighter-rouge">performance.now(): number</code></a> returns the high-resolution duration since the construction of the <code class="language-plaintext highlighter-rouge">Performance</code> object.</li>
  <li><a href="https://w3c.github.io/hr-time/#dom-performance-timeorigin"><code class="language-plaintext highlighter-rouge">performance.timeOrigin: number</code></a> is a high-resolution timestamp of the <code class="language-plaintext highlighter-rouge">Performance</code> object’s construction, expressed in <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a>.</li>
  <li><a href="https://w3c.github.io/hr-time/#dom-performance-tojson"><code class="language-plaintext highlighter-rouge">performance.toJSON(): object</code></a> returns an object with <code class="language-plaintext highlighter-rouge">timeOrigin</code> property set to the corresponding value of this object. This allows serializing the <code class="language-plaintext highlighter-rouge">Performance</code> object with <code class="language-plaintext highlighter-rouge">JSON.stringify()</code>. In browsers, the returned object may contain additional properties such as <code class="language-plaintext highlighter-rouge">navigation</code> and <code class="language-plaintext highlighter-rouge">timing</code>. However, those properties are specific to browser navigation and are unsuitable for a Node.js implementation. Furthermore, they are specified not in the High Resolution Time spec but in <a href="https://w3c.github.io/navigation-timing/">Navigation Timing</a>, and are thereby outside the scope of this module.</li>
</ul>

<h3 id="limitations">Limitations</h3>

<p>This module does not aim for full <a href="https://heycam.github.io/webidl/">Web IDL</a> conformance, so things like <code class="language-plaintext highlighter-rouge">performance.toJSON.call({})</code> will not throw <code class="language-plaintext highlighter-rouge">TypeError</code>s like it does in browsers. If you need full Web IDL conformance, you may be interested in the <a href="https://github.com/jsdom/webidl2js">webidl2js</a> module.</p>

<p>The <code class="language-plaintext highlighter-rouge">Performance</code> class provided also does not have <code class="language-plaintext highlighter-rouge">mark()</code>, <code class="language-plaintext highlighter-rouge">measure()</code>, <code class="language-plaintext highlighter-rouge">getEntries()</code>, and such functions. They are specified in other specs than High Resolution Timing, such as <a href="https://w3c.github.io/user-timing/">User Timing</a> (marks and measures) and <a href="https://w3c.github.io/performance-timeline/">Performance Timeline</a> (entries management). Those specs extend the definition of the <code class="language-plaintext highlighter-rouge">Performance</code> class defined in High Resolution Timing, and to implement those specs you can extend the <code class="language-plaintext highlighter-rouge">Performance</code> class exported by this module.</p>

<p>Due to the limitations of the APIs exposed through Node.js, the construction of a <code class="language-plaintext highlighter-rouge">Performance</code> object may take up to 1 millisecond to gather information for high-resolution <code class="language-plaintext highlighter-rouge">timeOrigin</code>.</p>

<h2 id="global-monotonic-clock">Global monotonic clock</h2>

<p>The High Resolution Time spec defines a <a href="https://w3c.github.io/hr-time/#dfn-global-monotonic-clock">global monotonic clock</a> that is “shared by time origin’s <em>[sic]</em>, is monotonically increasing and not subject to system clock adjustments or system clock skew, and whose reference point is the Unix time.”</p>

<p>This module exports a function <code class="language-plaintext highlighter-rouge">getGlobalMonotonicClockMS()</code> that is the basis of all timing functions used my this module when a monotonic time is required. It returns a high-resolution timestamp whose zero value is at some arbitrary point in the past. (For the current high-resolution timestamp based on the Unix epoch, use <code class="language-plaintext highlighter-rouge">new Performance().timeOrigin</code> instead.)</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">getGlobalMonotonicClockMS</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">w3c-hr-time</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">getGlobalMonotonicClockMS</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">start</span><span class="p">);</span>
<span class="c1">// Prints a millisecond timestamp based on an arbitrary point in the past, like</span>
<span class="c1">// 280249733.012151.</span>

<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getGlobalMonotonicClockMS</span><span class="p">()</span> <span class="o">-</span> <span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints a number close to 5000, like 5006.156536.</span>
<span class="p">},</span> <span class="mi">5000</span><span class="p">);</span>
</code></pre></div></div>

<p>Unlike other functions that return only integer timestamps if the system clock does not provide enough resolution, this function may still return timestamps with fractional parts on those systems with less accurate clocks. See “Clock accuracy” section below for more information.</p>

<h2 id="clock-accuracy">Clock accuracy</h2>

<p>The High Resolution Time spec <a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp">states</a> that</p>

<blockquote>
  <p>A <a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp"><code class="language-plaintext highlighter-rouge">DOMHighResTimeStamp</code></a> <em>SHOULD</em> represent a time in milliseconds accurate to 5 microseconds - see <a href="https://w3c.github.io/hr-time/#privacy-security">8. Privacy and Security</a>.</p>

  <p>If the User Agent is unable to provide a time value accurate to 5 microseconds due to hardware or software constraints, the User Agent can represent a <a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp"><code class="language-plaintext highlighter-rouge">DOMHighResTimeStamp</code></a> as a time in milliseconds accurate to a millisecond.</p>
</blockquote>

<p>This module implements this suggestion faithfully. It executes a test at <code class="language-plaintext highlighter-rouge">require()</code>-time to determine if the system clock (both <code class="language-plaintext highlighter-rouge">Date.now()</code> and <code class="language-plaintext highlighter-rouge">process.hrtime()</code>) is accurate enough to 5 microseconds. The result of this test can be accessed through the exported <code class="language-plaintext highlighter-rouge">clockIsAccurate</code> boolean value.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span> <span class="nx">Performance</span><span class="p">,</span> <span class="nx">clockIsAccurate</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">w3c-hr-time</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">performance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Performance</span><span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">clockIsAccurate</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">isInteger</span><span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">timeOrigin</span><span class="p">));</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Number</span><span class="p">.</span><span class="nx">isInteger</span><span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">()));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">clockIsAccurate</code> is false, <code class="language-plaintext highlighter-rouge">performance.timeOrigin</code> and <code class="language-plaintext highlighter-rouge">performance.now()</code> are always rounded to millisecond accuracy. <code class="language-plaintext highlighter-rouge">getGlobalMonotonicClockMS()</code> however is exempt from this requirement due to its best-effort nature, and the fact that it is not an API exposed by the High Resolution Time spec.</p>

<h2 id="clock-drift">Clock drift</h2>

<p><a href="https://en.wikipedia.org/wiki/Clock_drift">Clock drift</a> can be observed through system or user clock adjustments – that is, the speed at which <code class="language-plaintext highlighter-rouge">Date.now()</code> changes may be faster or slower than real time if there is a pending adjustment to the system clock, for example through NTP synchronizing.</p>

<p>In the spec, the <a href="https://w3c.github.io/hr-time/#dfn-global-monotonic-clock">global monotonic clock</a> is defined to be immune to such drifts. Correspondingly, the APIs exposed through this module that are defined using the global monotonic clock such as <code class="language-plaintext highlighter-rouge">performance.now()</code> and <code class="language-plaintext highlighter-rouge">getGlobalMonotonicClockMS()</code> are also guaranteed to reflect real time.</p>

<p>For example, if <code class="language-plaintext highlighter-rouge">performance.now()</code> returns 1000, it is guaranteed that the time of this call is exactly one second since the construction of the <code class="language-plaintext highlighter-rouge">Performance</code> object. But the difference in <code class="language-plaintext highlighter-rouge">Date.now()</code>’s value from the construction of the <code class="language-plaintext highlighter-rouge">Performance</code> object to when <code class="language-plaintext highlighter-rouge">performance.now()</code> returns 1000 may not be exactly 1000. You may also see <code class="language-plaintext highlighter-rouge">performance.now() - Date.now()</code> diverge over time as a result of clock drifts.</p>

<p>On the other hand, <code class="language-plaintext highlighter-rouge">performance.timeOrigin</code> returns the <em><a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a></em> at which the <code class="language-plaintext highlighter-rouge">Performance</code> object is constructed and relies on the current time exposed through <code class="language-plaintext highlighter-rouge">Date.now()</code>. That means that it is susceptible to clock drifts that has occurred before the <code class="language-plaintext highlighter-rouge">Performance</code> object was constructed.</p>

<h2 id="supporting-w3c-hr-time">Supporting w3c-hr-time</h2>

<p>The jsdom project (including w3c-hr-time) is a community-driven project maintained by a team of <a href="https://github.com/orgs/jsdom/people">volunteers</a>. You could support us by:</p>

<ul>
  <li><a href="https://tidelift.com/subscription/pkg/npm-w3c-hr-time?utm_source=npm-w3c-hr-time&amp;utm_medium=referral&amp;utm_campaign=readme">Getting professional support for w3c-hr-time</a> as part of a Tidelift subscription. Tidelift helps making open source sustainable for us while giving teams assurances for maintenance, licensing, and security.</li>
  <li>Contributing directly to the project.</li>
</ul>

<h2 id="license">License</h2>

<p>This software is licensed under the MIT license. See LICENSE.md file for more detail.</p>



      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
