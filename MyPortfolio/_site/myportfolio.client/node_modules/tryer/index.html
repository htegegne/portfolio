<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>tryer | portfolio</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="tryer" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/myportfolio.client/node_modules/tryer/" />
<meta property="og:url" content="http://localhost:4000/myportfolio.client/node_modules/tryer/" />
<meta property="og:site_name" content="portfolio" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="tryer" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"tryer","url":"http://localhost:4000/myportfolio.client/node_modules/tryer/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=00c08f3bd19ad2390c706d50e4f8968f8b47944c">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">portfolio</a></h1>
      

      <h1 id="tryer">tryer</h1>

<p><a href="https://gitlab.com/philbooth/tryer/pipelines"><img src="https://gitlab.com/philbooth/tryer/badges/master/pipeline.svg" alt="Build status" /></a>
<a href="https://www.npmjs.com/package/tryer"><img src="https://img.shields.io/npm/v/tryer.svg" alt="Package status" /></a>
<a href="https://www.npmjs.com/package/tryer"><img src="https://img.shields.io/npm/dm/tryer.svg" alt="Downloads" /></a>
<a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/npm/l/tryer.svg" alt="License" /></a></p>

<p>Because everyone loves a tryer!
Conditional
and repeated
function invocation
for node
and browser.</p>

<ul>
  <li><a href="#say-what">Say what?</a></li>
  <li><a href="#what-size-is-it">What size is it?</a></li>
  <li><a href="#how-do-i-install-it">How do I install it?</a></li>
  <li><a href="#how-do-i-use-it">How do I use it?</a>
    <ul>
      <li><a href="#loading-the-library">Loading the library</a></li>
      <li><a href="#calling-the-exported-function">Calling the exported function</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>
  </li>
  <li><a href="#how-do-i-set-up-the-dev-environment">How do I set up the dev environment?</a></li>
  <li><a href="#what-license-is-it-released-under">What license is it released under?</a></li>
</ul>

<h2 id="say-what">Say what?</h2>

<p>Sometimes,
you want to defer
calling a function
until a certain
pre-requisite condition is met.
Other times,
you want to
call a function
repeatedly
until some post-requisite condition
is satisfied.
Occasionally,
you might even want
to do both
for the same function.</p>

<p>To save you writing
explicit conditions
and loops
on each of those occasions,
<code class="language-plaintext highlighter-rouge">tryer</code> implements
a predicate-based approach
that hides the cruft
behind a simple,
functional interface.</p>

<p>Additionally,
it allows you to easily specify
retry intervals
and limits,
so that your code
doesnâ€™t hog the CPU.
It also supports
exponential backoff
of retry intervals,
which can be useful
when handling
indefinite error states
such as network failure.</p>

<h2 id="what-size-is-it">What size is it?</h2>

<p>5.6 kb unminified with comments, 1.1 kb minified, 0.5 kb minified + gzipped.</p>

<h2 id="how-do-i-install-it">How do I install it?</h2>

<p>Via npm:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i tryer --save
</code></pre></div></div>

<p>Or if you just want the git repo:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@gitlab.com:philbooth/tryer.git
</code></pre></div></div>

<h2 id="how-do-i-use-it">How do I use it?</h2>

<h3 id="loading-the-library">Loading the library</h3>

<p>If you are running in
Node.js
or another CommonJS-style
environment,
you can <code class="language-plaintext highlighter-rouge">require</code>
tryer like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">tryer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">tryer</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>It also the supports
the AMD-style format
preferred by Require.js.</p>

<p>If you are
including <code class="language-plaintext highlighter-rouge">tryer</code>
with an HTML <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag,
or neither of the above environments
are detected,
it will be exported globally as <code class="language-plaintext highlighter-rouge">tryer</code>.</p>

<h3 id="calling-the-exported-function">Calling the exported function</h3>

<p><code class="language-plaintext highlighter-rouge">tryer</code> is a function
that can be invoked to
call other functions
conditionally and repeatedly,
without the need for
explicit <code class="language-plaintext highlighter-rouge">if</code> statements
or loops in your own code.</p>

<p><code class="language-plaintext highlighter-rouge">tryer</code> takes one argument,
an options object
that supports
the following properties:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action</code>:
The function that you want to invoke.
If <code class="language-plaintext highlighter-rouge">action</code> returns a promise,
iterations will not end
until the promise is resolved or rejected.
Alternatively,
<code class="language-plaintext highlighter-rouge">action</code> may take a callback argument, <code class="language-plaintext highlighter-rouge">done</code>,
to signal that it is asynchronous.
In that case,
you are responsible
for calling <code class="language-plaintext highlighter-rouge">done</code>
when the action is finished.
If <code class="language-plaintext highlighter-rouge">action</code> is not set,
it defaults to an empty function.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">when</code>:
A predicate
that tests the pre-condition
for invoking <code class="language-plaintext highlighter-rouge">action</code>.
Until <code class="language-plaintext highlighter-rouge">when</code> returns true
(or a truthy value),
<code class="language-plaintext highlighter-rouge">action</code> will not be called.
Defaults to
a function that immediately returns <code class="language-plaintext highlighter-rouge">true</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">until</code>:
A predicate
that tests the post-condition
for invoking <code class="language-plaintext highlighter-rouge">action</code>.
After <code class="language-plaintext highlighter-rouge">until</code> returns true
(or a truthy value),
<code class="language-plaintext highlighter-rouge">action</code> will no longer be called.
Defaults to
a function that immediately returns <code class="language-plaintext highlighter-rouge">true</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">fail</code>:
The error handler.
A function
that will be called
if <code class="language-plaintext highlighter-rouge">limit</code> falsey values
are returned by <code class="language-plaintext highlighter-rouge">when</code> or <code class="language-plaintext highlighter-rouge">until</code>.
Defaults to an empty function.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pass</code>:
Success handler.
A function
that will be called
after <code class="language-plaintext highlighter-rouge">until</code> has returned truthily.
Defaults to an empty function.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">limit</code>:
Failure limit,
representing the maximum number
of falsey returns from <code class="language-plaintext highlighter-rouge">when</code> or <code class="language-plaintext highlighter-rouge">until</code>
that will be permitted
before invocation is deemed to have failed.
A negative number
indicates that the attempt
should never fail,
instead continuing 
for as long as <code class="language-plaintext highlighter-rouge">when</code> and <code class="language-plaintext highlighter-rouge">until</code>
have returned truthy values.
Defaults to <code class="language-plaintext highlighter-rouge">-1</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">interval</code>:
The retry interval,
in milliseconds.
A negative number indicates
that each subsequent retry
should wait for twice the interval
from the preceding iteration
(i.e. exponential backoff).
The default value is <code class="language-plaintext highlighter-rouge">-1000</code>,
signifying that
the initial retry interval
should be one second
and that each subsequent attempt
should wait for double the length
of the previous interval.</p>
  </li>
</ul>

<h3 id="examples">Examples</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Attempt to insert a database record, waiting until `db.isConnected`</span>
<span class="c1">// before doing so. The retry interval is 1 second on each iteration</span>
<span class="c1">// and the call will fail after 10 attempts.</span>
<span class="nx">tryer</span><span class="p">({</span>
  <span class="na">action</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">record</span><span class="p">),</span>
  <span class="na">when</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">isConnected</span><span class="p">,</span>
  <span class="na">interval</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="nx">fail</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">No database connection, terminating.</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Attempt to send an email message, optionally retrying with</span>
<span class="c1">// exponential backoff starting at 1 second. Continue to make</span>
<span class="c1">// attempts indefinitely until the call succeeds.</span>
<span class="kd">let</span> <span class="nx">sent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">tryer</span><span class="p">({</span>
  <span class="nx">action</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">smtp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">sent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="na">until</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">sent</span><span class="p">,</span>
  <span class="na">interval</span><span class="p">:</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span>
  <span class="na">limit</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">});</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Poll a device at 30-second intervals, continuing indefinitely.</span>
<span class="nx">tryer</span><span class="p">({</span>
  <span class="na">action</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">device</span><span class="p">.</span><span class="nx">poll</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">response</span><span class="p">)),</span>
  <span class="na">interval</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
  <span class="na">limit</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="how-do-i-set-up-the-dev-environment">How do I set up the dev environment?</h2>

<p>The dev environment relies on
<a href="http://chaijs.com/">Chai</a>,
<a href="http://jshint.com/">JSHint</a>,
<a href="http://mochajs.org/">Mocha</a>,
<a href="https://gitlab.com/philbooth/please-release-me">please-release-me</a>,
<a href="https://gitlab.com/philbooth/spooks.js">spooks.js</a> and
<a href="http://lisperator.net/uglifyjs/">UglifyJS</a>.
The source code is in
<code class="language-plaintext highlighter-rouge">src/tryer.js</code>
and the unit tests are in
<code class="language-plaintext highlighter-rouge">test/unit.js</code>.</p>

<p>To install the dependencies:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i
</code></pre></div></div>

<p>To run the tests:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm t
</code></pre></div></div>

<p>To lint the code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm run lint
</code></pre></div></div>

<p>To regenerate the minified lib:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm run minify
</code></pre></div></div>

<h2 id="what-license-is-it-released-under">What license is it released under?</h2>

<p><a href="/myportfolio.client/node_modules/tryer/COPYING">MIT</a></p>



      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
