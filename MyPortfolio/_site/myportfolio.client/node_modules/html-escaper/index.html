<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>html-escaper | portfolio</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="html-escaper" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/myportfolio.client/node_modules/html-escaper/" />
<meta property="og:url" content="http://localhost:4000/myportfolio.client/node_modules/html-escaper/" />
<meta property="og:site_name" content="portfolio" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="html-escaper" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"html-escaper","url":"http://localhost:4000/myportfolio.client/node_modules/html-escaper/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=059dd2210d8f0fb8d42af0cbb5c1b29e59b98886">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">portfolio</a></h1>
      

      <h1 id="html-escaper--">html-escaper <a href="https://travis-ci.org/WebReflection/html-escaper"><img src="https://travis-ci.org/WebReflection/html-escaper.svg?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/WebReflection/html-escaper?branch=master"><img src="https://coveralls.io/repos/github/WebReflection/html-escaper/badge.svg?branch=master" alt="Coverage Status" /></a></h1>
<p>A simple module to escape/unescape common problematic entities.</p>

<h3 id="how">How</h3>
<p>This package is available in npm so <code class="language-plaintext highlighter-rouge">npm install html-escaper</code> is all you need to do, using eventually the global flag too.</p>

<p>Once the module is present</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">html-escaper</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// two basic methods</span>
<span class="nx">html</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">html</span><span class="p">.</span><span class="nx">unescape</span><span class="p">(</span><span class="dl">'</span><span class="s1">escaped string</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="why">Why</h3>
<p>there is basically one rule only: do not <strong>ever</strong> replace one char after another if you are transforming a string into another.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// WARNING: THIS IS WRONG</span>
<span class="c1">// if you are that kind of dev that does this</span>
<span class="kd">function</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;amp;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;lt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;gt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/'/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;#39;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/"/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;quot;</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// you might be the same dev that does this too</span>
<span class="kd">function</span> <span class="nx">unescape</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;amp;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;lt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&lt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;gt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;#39;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">'</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;quot;/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// guess what we have here ?</span>
<span class="nx">unescape</span><span class="p">(</span><span class="dl">'</span><span class="s1">&amp;amp;lt;</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// now guess this XSS too ...</span>
<span class="nx">unescape</span><span class="p">(</span><span class="dl">'</span><span class="s1">&amp;amp;lt;script&amp;amp;gt;alert("yo")&amp;amp;lt;/script&amp;amp;gt;</span><span class="dl">'</span><span class="p">);</span>


</code></pre></div></div>

<p>The last example will produce <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert("yo")&lt;/script&gt;</code> instead of the expected <code class="language-plaintext highlighter-rouge">&amp;lt;script&amp;gt;alert("yo")&amp;lt;/script&amp;gt;</code>.</p>

<p>Nothing like this could possibly happen if we grab all chars at once and either ways.
It’s just a fortunate case that after swapping <code class="language-plaintext highlighter-rouge">&amp;</code> with <code class="language-plaintext highlighter-rouge">&amp;amp;</code> no other replace will be affected, but it’s not portable and universally a bad practice.</p>

<p>Grab all chars at once, no excuses!</p>

<p><strong>more details</strong>
As somebody might think it’s an <code class="language-plaintext highlighter-rouge">unescape</code> issue only, it’s not. Being an anti-pattern with side effects works both ways.</p>

<p>As example, changing the order of the replacement in escaping would produce the unexpected:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;lt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;gt;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/'/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;#39;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/"/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;quot;</span><span class="dl">"</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&amp;amp;</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">escape</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// &amp;amp;lt; instead of &amp;lt;</span>
</code></pre></div></div>
<p>If we do not want to code with the fear that the order wasn’t perfect or that our order in either escaping or unescaping is different from the order another method or function used, if we understand the issue and we agree it’s potentially a disaster prone approach, if we add the fact in this case creating 4 RegExp objects each time and invoking 4 times <code class="language-plaintext highlighter-rouge">.replace</code> trough the <code class="language-plaintext highlighter-rouge">String.prototype</code> is also potentially slower than creating one function only holding one object, or holding the function too, we should agree there is not absolutely any valid reason to keep proposing a char-by-char implementation.</p>

<p>We have proofs this approach can fail already so … why should we risk? Just avoid and grab all chars at once or simply use this tiny utility.</p>

<h3 id="backtick">Backtick</h3>
<p>Internt explorer &lt; 9 has <a href="https://html5sec.org/#102">some backtick issue</a></p>

<p>For compatibility sake with common server-side HTML entities encoders and decoders, and in order to have the most reliable I/O, this little utility will NOT fix this IE &lt; 9 problem.</p>

<p>It is also important to note that if we create valid HTML and we set attributes at runtime through this utility, backticks in strings cannot possibly affect attribute behaviors.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span>
  <span class="dl">'</span><span class="s1">x` `&lt;script&gt;alert(1)&lt;/script&gt;"` `</span><span class="dl">'</span>
<span class="p">);</span>
<span class="c1">// it won't cause problems even in IE &lt; 9</span>
</code></pre></div></div>

<p><strong>However</strong>, if you use <code class="language-plaintext highlighter-rouge">innerHTML</code> and you target IE &lt; 9 then <a href="https://github.com/nette/nette/issues/1496">this <strong>might</strong> be a problem</a>.</p>

<p>Accordingly, if you need more chars and/or backticks to be escaped and unescaped, feel free to use alternatives like <a href="https://github.com/lodash/lodash">lodash</a> or <a href="https://www.npmjs.com/package/he">he</a></p>

<p>Here a bit more of <a href="https://github.com/WebReflection/html-escaper/commit/52d554fc6e8583b6ffdd357967cf71962fc07cf6#commitcomment-10625122">my POV</a> and why I haven’t implemented same thing alternatives did. Good news: those are alternatives ;-)</p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
